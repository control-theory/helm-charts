# REQUIRED: Deployment environment (e.g., "dev", "stage", "prod")
environment: ""

# REQUIRED: Kubernetes cluster name (e.g., "demo-cluster")
cluster: ""

# Container image configuration
image:
  registry: controltheory
  repository: aigent
  pullPolicy: Always
  # Image tag - override this to use different builds (e.g., "latest", "v1.0.0", "stage")
  tag: ""  # If empty, defaults to Chart appVersion

# Deployment configuration
deployment:
  replicas: 1
  args:
    - "--debug"
    - "start"
  env:
    # jemalloc configuration for DuckDB/ChDB memory management
    # dirty_decay_ms: how long before dirty pages are purged (default: 10000ms)
    # muzzy_decay_ms: how long before muzzy pages are purged (default: 10000ms)
    # background_thread:true enables background purging thread
    # narenas: number of arenas (default: 4 * num_cpus)
    MALLOC_CONF: "dirty_decay_ms:5000,muzzy_decay_ms:5000,background_thread:true"

# Resource limits and requests
resources:
  enabled: true
  cpu:
    request: 100m
    limit: 250m
  memory:
    request: 500Mi
    limit: 1Gi

# Service account
serviceAccount:
  create: true
  name: ""  # If not set, a name is generated using the release name

# Port configuration
ports:
  otelhttp: 1757
  otelgrpc: 1758
  pprof: 1958
  tallyman: 7758

# Service configuration
service:
  otelhttp:
    type: ClusterIP
  otelgrpc:
    type: ClusterIP
  tallyman:
    type: ClusterIP

# Autoscaling
autoscaling:
  enabled: false

# Gateway mode - enables full collector capabilities
# When enabled: k8s events collection, full processor chains, k8s metadata enrichment
# When disabled: minimal processing, receives pre-processed data
gateway:
  enabled: false
  # Namespaces to include in k8sobjects event collection (mutually exclusive with excludeNamespaces)
  # If empty, all namespaces are included
  # Example: includeNamespaces: [default, production, staging]
  includeNamespaces: []
  # NOTE: Namespace exclusion is not currently supported due to aigent binary limitations
  # The filter processor is not compiled into aigent
  # To exclude namespaces, use includeNamespaces with an explicit list instead
  excludeNamespaces: []

# AhoLogs pattern matching is always enabled for log analysis

# Accumulator configuration
# ChDB Accumulator: uses ChDB SQL-based accumulator instead of in-memory
# DuckDB Accumulator: uses DuckDB SQL-based accumulator instead of in-memory
# WARNING: Only enable ONE accumulator - enabling both will cause errors
useChdbAccumulator: false
useDuckDBAccumulator: true

# Butler endpoint configuration
# REQUIRED: Full butler address in format: butler.<namespace>.<environment>.controltheory.com:443
# Example: butler.oapwf2hny.stage.controltheory.com:443
butler:
  endpoint: ""
  useTLS: true

# Bobo API configuration (OpenAI provider via LiteLLM)
# REQUIRED: Bobo API provides LLM-based log analysis
boboAPI:
  enable: true  # Always enabled for aigent role
  provider: "openai"  # Only openai provider is supported

  # OpenAI provider configuration (via LiteLLM)
  openai:
    apiKey: ""  # REQUIRED: LiteLLM API key (set via --set or secret)
    baseURL: ""  # REQUIRED: LiteLLM endpoint (e.g., http://litellm.litellm.svc.cluster.local:4000/v1)
    model: "bobo-baconbits"  # Model name (must exist in LiteLLM config)
    temperature: 0.3
    maxTokens: 0  # 0 means use model default
    maxLogSamples: 100
